/**************************************
	Webutler V3.2 - www.webutler.de
	Copyright (c) 2008 - 2016
	Autor: Sven Zinke
	Free for any use
	Lizenz: GPL
**************************************/
(function()
{var plugin=CKEDITOR.plugins.get('columns');CKEDITOR.document.appendStyleSheet(CKEDITOR.getUrl(plugin.path+'dialogs/columns.css'));CKEDITOR.dialog.add('columns',function(editor)
{var lang=editor.lang.columns;function objectsize(obj){var size=0,key;for(key in obj){if(obj.hasOwnProperty(key))size++;}
return size;}
function getConfigTemplate(num)
{var colconf='<td>'+'<div class="wbcke_colconf wbcke_colconf_'+editor.name+'">\n'+'<table border="0" cellspacing="0" cellpadding="0">\n'+'<tr>\n'+'<td colspan="3" style="padding-bottom: 10px !important"><strong>'+lang.column+' '+num+'</strong></td>\n'+'</tr>\n'+'<tr>\n'+'<td colspan="3" style="padding-bottom: 10px !important">'+lang.align+': <select id="wbcke_colalign_'+editor.name+'_'+num+'" size="1" class="cke_dialog_ui_input_select wbcke_select">\n'+'<option value="top">'+lang.top+'</option>\n'+'<option value="middle">'+lang.middle+'</option>\n'+'<option value="bottom">'+lang.bottom+'</option>\n'+'<option value="full">'+lang.full+'</option>\n'+'</select>\n'+'</td>\n'+'</tr>\n'+'<tr>\n'+'<td>&nbsp;</td>\n'+'<td>'+lang.width+'</td>\n'+'<td>'+lang.order+'</td>\n'+'</tr>\n'+'<tr>\n'+'<td>'+lang.colsmall+'</td>\n'+'<td>\n'+'<select id="wbcke_colsmall_'+editor.name+'_'+num+'" size="1" class="cke_dialog_ui_input_select wbcke_select">\n'+'<option value="hide">'+lang.hide+'</option>\n'+'<option value="1">1 / 12</option>\n'+'<option value="2">2 / 12</option>\n'+'<option value="3">3 / 12</option>\n'+'<option value="4">4 / 12</option>\n'+'<option value="5">5 / 12</option>\n'+'<option value="6">6 / 12</option>\n'+'<option value="7">7 / 12</option>\n'+'<option value="8">8 / 12</option>\n'+'<option value="9">9 / 12</option>\n'+'<option value="10">10 / 12</option>\n'+'<option value="11">11 / 12</option>\n'+'<option value="12">12 / 12</option>\n'+'</select>\n'+'</td>\n'+'<td><input type="text" id="wbcke_ordersmall_'+editor.name+'_'+num+'" value="'+num+'" class="cke_dialog_ui_input_text wbcke_order" /></td>\n'+'</tr>\n'+'<tr>\n'+'<td>'+lang.colmedium+'</td>\n'+'<td>\n'+'<select id="wbcke_colmedium_'+editor.name+'_'+num+'" size="1" class="cke_dialog_ui_input_select wbcke_select">\n'+'<option value="hide">'+lang.hide+'</option>\n'+'<option value="1">1 / 12</option>\n'+'<option value="2">2 / 12</option>\n'+'<option value="3">3 / 12</option>\n'+'<option value="4">4 / 12</option>\n'+'<option value="5">5 / 12</option>\n'+'<option value="6">6 / 12</option>\n'+'<option value="7">7 / 12</option>\n'+'<option value="8">8 / 12</option>\n'+'<option value="9">9 / 12</option>\n'+'<option value="10">10 / 12</option>\n'+'<option value="11">11 / 12</option>\n'+'<option value="12">12 / 12</option>\n'+'</select>\n'+'</td>\n'+'<td><input type="text" id="wbcke_ordermedium_'+editor.name+'_'+num+'" value="'+num+'" class="cke_dialog_ui_input_text wbcke_order" /></td>\n'+'</tr>\n'+'<tr>\n'+'<td>'+lang.collarge+'</td>\n'+'<td>\n'+'<select id="wbcke_collarge_'+editor.name+'_'+num+'" size="1" class="cke_dialog_ui_input_select wbcke_select">\n'+'<option value="hide">'+lang.hide+'</option>\n'+'<option value="1">1 / 12</option>\n'+'<option value="2">2 / 12</option>\n'+'<option value="3">3 / 12</option>\n'+'<option value="4">4 / 12</option>\n'+'<option value="5">5 / 12</option>\n'+'<option value="6">6 / 12</option>\n'+'<option value="7">7 / 12</option>\n'+'<option value="8">8 / 12</option>\n'+'<option value="9">9 / 12</option>\n'+'<option value="10">10 / 12</option>\n'+'<option value="11">11 / 12</option>\n'+'<option value="12">12 / 12</option>\n'+'</select>\n'+'</td>\n'+'<td><input type="text" id="wbcke_orderlarge_'+editor.name+'_'+num+'" value="'+num+'" class="cke_dialog_ui_input_text wbcke_order" /></td>\n'+'</tr>\n'+'<tr>\n'+'<td colspan="3" style="padding-top: 10px !important">'+lang.colcss+':</td>\n'+'</tr>\n'+'<tr>\n'+'<td colspan="3"><input type="text" id="wbcke_colcss_'+editor.name+'_'+num+'" value="" class="cke_dialog_ui_input_text" /></td>\n'+'</tr>\n'+'</table>\n'+'</div>\n'+'</td>\n';return colconf;}
function setColumnWidths(templates,len){var selection=len==2||len==3||len==4||len==6?12/len:1;var optiontag='<option value="'+selection+'">';var optionregexp=new RegExp(optiontag,'g');templates=templates.replace(optionregexp,'<option value="'+selection+'" selected="selected">');return templates;}
function loadColumnTemplate(len){var templates='';for(var i=1;i<=len;i++){templates+=getConfigTemplate(i);}
return setColumnWidths(templates,len);}
function createColumnItems(){var dialog=CKEDITOR.dialog.getCurrent();var rowclass=dialog.getValueOf('info','rowcss');var colconfs=document.getElementsByClassName('wbcke_colconf_'+editor.name);var colconfig={};var colclasses={};for(var i=0;i<colconfs.length;i++){var num=parseInt(i+1);colconfig['col'+num]={};colconfig['col'+num]['align']=document.getElementById('wbcke_colalign_'+editor.name+'_'+num).options[document.getElementById('wbcke_colalign_'+editor.name+'_'+num).selectedIndex].value;colconfig['col'+num]['small']=document.getElementById('wbcke_colsmall_'+editor.name+'_'+num).options[document.getElementById('wbcke_colsmall_'+editor.name+'_'+num).selectedIndex].value;colconfig['col'+num]['medium']=document.getElementById('wbcke_colmedium_'+editor.name+'_'+num).options[document.getElementById('wbcke_colmedium_'+editor.name+'_'+num).selectedIndex].value;colconfig['col'+num]['large']=document.getElementById('wbcke_collarge_'+editor.name+'_'+num).options[document.getElementById('wbcke_collarge_'+editor.name+'_'+num).selectedIndex].value;colconfig['col'+num]['order']={};colconfig['col'+num]['order']['s']=document.getElementById('wbcke_ordersmall_'+editor.name+'_'+num).value;colconfig['col'+num]['order']['m']=document.getElementById('wbcke_ordermedium_'+editor.name+'_'+num).value;colconfig['col'+num]['order']['l']=document.getElementById('wbcke_orderlarge_'+editor.name+'_'+num).value;if(document.getElementById('wbcke_colcss_'+editor.name+'_'+num).value!='')
colclasses['col'+num]=document.getElementById('wbcke_colcss_'+editor.name+'_'+num).value;}
var columnpreview=generateSource(colconfig,rowclass,colclasses);insertColumns(columnpreview);}
function generateSource(colconfig,rowclass,colclasses)
{var source='';if(rowclass!='')
source+='<div class="wb_innercolumns '+rowclass.replace(/^[\p{L}\p{N}\_\- ]$/g,"")+'">\n';source+='\t<div class="wb_colgroup">\n\t\t<div class="wb_colrow">\n';var collength=parseInt(objectsize(colconfig)+1);for(var i=1;i<collength;i++){var orders=[];var align='';var classes=[];for(var key in colconfig['col'+i]){if(key=='order'){for(var k in colconfig['col'+i]['order']){if(colconfig['col'+i]['order'][k]!='')
orders.push('wb_colorder_'+k+colconfig['col'+i]['order'][k]);}}
else{if(key=='align'){align='wb_colalign_'+colconfig['col'+i]['align'];}
else{if(colconfig['col'+i][key]!='')
classes.push('wb_col'+key+'_'+colconfig['col'+i][key]);}}}
var colclass='';if(objectsize(colclasses)>0&&colclasses['col'+i]!='')
colclass=' '+colclasses['col'+i].replace(/^[\p{L}\p{N}\_\- ]$/g,"");var bind=classes.length>0&&orders.length>0?' ':'';source+='\t\t\t<div class="'+classes.join(' ')+bind+orders.join(' ')+colclass+'">\n\t\t\t\t<div class="'+align+'">\n\t\t\t\t\t<p>&nbsp;</p>\n\t\t\t\t</div>\n\t\t\t</div>\n';}
source+='\t\t</div>\n\t</div>\n';if(rowclass!='')
source+='</div>\n';return source;}
function insertColumns(html){var dialog=CKEDITOR.dialog.getCurrent();if(wbcke_setmargintop=='1'){var margin=prompt(wbcke_setmargintext,'');if(margin!=''&&margin!=null)
{var searchfirst=html.indexOf('>');var first=html.substring(0,searchfirst);var rest=html.substring(searchfirst,html.length);var hasstyle=first.match(/ style="/gi);var newfirst;if(hasstyle){newfirst=first.replace(/ style="/gi,' style="margin-top: '+margin+'px; ');}
else{newfirst=first+' style="margin-top: '+margin+'px"';}
html=newfirst+rest;}}
editor.insertHtml(html);dialog.hide();}
var working=false;function activestate(defnum){var numbers=document.getElementsByClassName('wbcke_colnums_'+editor.name);for(var i=0;i<numbers.length;i++){if(numbers[i].classList.contains('active'))
numbers[i].classList.remove('active');}
if(defnum!=null)
numbers[defnum-2].classList.add('active');if(!working){var dialog=CKEDITOR.dialog.getCurrent();dialog.getContentElement('info','columnstext').getElement().hide();dialog.getContentElement('info','rowcss').getElement().show();}}
function reCenterDialog(){if(!working){var dialog=CKEDITOR.dialog.getCurrent();var dialogSize=dialog.getSize();var winSize=CKEDITOR.document.getWindow().getViewPaneSize();var newx=(winSize.width-dialogSize.width)/2;var newy=(winSize.height-dialogSize.height)/2;dialog.move(newx,newy);working=true;}}
return{title:lang.title,minWidth:CKEDITOR.env.ie?740:700,minHeight:70,contents:[{id:'info',label:lang.title,elements:[{type:'vbox',padding:5,children:[{type:'html',id:'columnslength',html:'<strong>'+lang.columnslength+'</strong>'},{type:'hbox',widths:['27px','27px','27px','27px','27px','27px','27px','27px','27px','27px','27px',''],children:[{type:'html',id:'colnum2',html:'<span class="wbcke_colnums wbcke_colnums_'+editor.name+'">2</span>',onClick:function()
{activestate(2);var source=loadColumnTemplate(2);document.getElementById('wbcke_colconfigs_'+editor.name).innerHTML=source;reCenterDialog();}},{type:'html',id:'colnum3',html:'<span class="wbcke_colnums wbcke_colnums_'+editor.name+'">3</span>',onClick:function()
{activestate(3);var source=loadColumnTemplate(3);document.getElementById('wbcke_colconfigs_'+editor.name).innerHTML=source;reCenterDialog();}},{type:'html',id:'colnum4',html:'<span class="wbcke_colnums wbcke_colnums_'+editor.name+'">4</span>',onClick:function()
{activestate(4);var source=loadColumnTemplate(4);document.getElementById('wbcke_colconfigs_'+editor.name).innerHTML=source;reCenterDialog();}},{type:'html',id:'colnum5',html:'<span class="wbcke_colnums wbcke_colnums_'+editor.name+'">5</span>',onClick:function()
{activestate(5);var source=loadColumnTemplate(5);document.getElementById('wbcke_colconfigs_'+editor.name).innerHTML=source;reCenterDialog();}},{type:'html',id:'colnum6',html:'<span class="wbcke_colnums wbcke_colnums_'+editor.name+'">6</span>',onClick:function()
{activestate(6);var source=loadColumnTemplate(6);document.getElementById('wbcke_colconfigs_'+editor.name).innerHTML=source;reCenterDialog();}},{type:'html',id:'colnum7',html:'<span class="wbcke_colnums wbcke_colnums_'+editor.name+'">7</span>',onClick:function()
{activestate(7);var source=loadColumnTemplate(7);document.getElementById('wbcke_colconfigs_'+editor.name).innerHTML=source;reCenterDialog();}},{type:'html',id:'colnum8',html:'<span class="wbcke_colnums wbcke_colnums_'+editor.name+'">8</span>',onClick:function()
{activestate(8);var source=loadColumnTemplate(8);document.getElementById('wbcke_colconfigs_'+editor.name).innerHTML=source;reCenterDialog();}},{type:'html',id:'colnum9',html:'<span class="wbcke_colnums wbcke_colnums_'+editor.name+'">9</span>',onClick:function()
{activestate(9);var source=loadColumnTemplate(9);document.getElementById('wbcke_colconfigs_'+editor.name).innerHTML=source;reCenterDialog();}},{type:'html',id:'colnum10',html:'<span class="wbcke_colnums wbcke_colnums_'+editor.name+'">10</span>',onClick:function()
{activestate(10);var source=loadColumnTemplate(10);document.getElementById('wbcke_colconfigs_'+editor.name).innerHTML=source;reCenterDialog();}},{type:'html',id:'colnum11',html:'<span class="wbcke_colnums wbcke_colnums_'+editor.name+'">11</span>',onClick:function()
{activestate(11);var source=loadColumnTemplate(11);document.getElementById('wbcke_colconfigs_'+editor.name).innerHTML=source;reCenterDialog();}},{type:'html',id:'colnum12',html:'<span class="wbcke_colnums wbcke_colnums_'+editor.name+'">12</span>',onClick:function()
{activestate(12);var source=loadColumnTemplate(12);document.getElementById('wbcke_colconfigs_'+editor.name).innerHTML=source;reCenterDialog();}},{type:'html',html:' '}]},{type:'html',id:'columnstext',html:lang.columnstext,'style':'margin-top: 30px; display: block;'},{type:'text',id:'rowcss',label:lang.rowcss,'style':'width: 35%; display: none;'},{type:'html',id:'colconfs',html:'<div class="wbcke_colconfigs">\n'+'<table border="0" cellspacing="0" cellpadding="0" align="left">\n'+'<tr id="wbcke_colconfigs_'+editor.name+'">\n'+'</tr>\n'+'</table>\n'+'</div>'}]}]}],buttons:[{type:'button',id:'linkok',label:'OK',title:'OK','class':'cke_dialog_ui_button_linkok',onClick:function(){createColumnItems();}},CKEDITOR.dialog.cancelButton],onHide:function(){var dialog=CKEDITOR.dialog.getCurrent();dialog.getContentElement('info','columnstext').getElement().show();dialog.getContentElement('info','rowcss').getElement().hide();document.getElementById('wbcke_colconfigs_'+editor.name).innerHTML='';activestate();working=false;}};});})();